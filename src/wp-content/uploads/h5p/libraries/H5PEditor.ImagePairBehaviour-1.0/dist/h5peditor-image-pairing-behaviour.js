(()=>{"use strict";var i=function(){function i(i,e,n,t){var s=this;this.parent=i,this.field=e,this.params=n,this.setValue=t,this.changes=[],this.passReadies=!0,this.$container=H5P.jQuery("<div>",{class:"h5peditor-imagesequencingbehaviour"}),this.fieldInstance=new H5PEditor.widgets[this.field.type](this.parent,this.field,this.params,this.setValue),this.fieldInstance.appendTo(this.$container),this.children=this.fieldInstance.children,this.fieldInstance.changes&&this.fieldInstance.changes.push((function(){s.handleFieldChange()})),this.$errors=this.$container.find(".h5p-errors"),this.parent.ready((function(){s.handleParentReady()}))}var e=i.prototype;return e.appendTo=function(i){this.$container.appendTo(i)},e.validate=function(){return this.fieldInstance.validate()},e.remove=function(){this.$container.remove()},e.initFieldMaxColumns=function(){this.fieldMaxColumns.field=this.fieldMaxColumns.field||{},this.fieldMaxColumns.field.min=this.fieldMaxColumns.field.min||1,this.fieldMaxColumns.field.max=Math.max(this.fieldMaxColumns.field.min,(this.listCards.getValue()||[]).length)},e.setFieldMaxColumnsMax=function(i){this.fieldMaxColumns.field.max=Math.max(this.fieldMaxColumns.field.min,i)},e.findCards=function(i){return i.children&&i.children.filter((function(i){return i instanceof H5PEditor.List&&0===i.getId().indexOf("field-cards")})).shift()||!1},e.handleFieldChange=function(){var i=this;this.params=this.fieldInstance.params,this.changes.forEach((function(e){e(i.params)}))},e.handleParentReady=function(){var i=this;this.listCards=this.findCards(this.parent),this.fieldEnforceColumns=H5PEditor.findField("behaviour/enforceColumns",this.parent),this.fieldMaxColumns=H5PEditor.findField("behaviour/maxColumns",this.parent),this.fieldEnforceColumns&&this.fieldMaxColumns&&this.listCards&&(this.initFieldMaxColumns(),this.listCards.on("addedItem",(function(){i.handlelistCardsChanged(),i.handleFieldMaxColumnsChanged()})),this.listCards.on("removedItem",(function(){i.handlelistCardsChanged(),i.fieldMaxColumns.$input.val((i.listCards.getValue()||[]).length),i.fieldMaxColumns.$input.change()})),this.fieldEnforceColumns.changes.push((function(e){i.handleFieldEnforceColumnsChanged(e)})),this.fieldMaxColumns.$input.on("change",(function(){i.handleFieldMaxColumnsChanged()})))},e.handlelistCardsChanged=function(){this.setFieldMaxColumnsMax((this.listCards.getValue()||[]).length)},e.handleFieldEnforceColumnsChanged=function(i){this.fieldMaxColumns.$input.change(),i&&(this.fieldMaxColumns.$errors.html().length>0||void 0===this.fieldMaxColumns.value&&this.fieldMaxColumns.$errors.html("<p>".concat(H5PEditor.t("H5PEditor.ImagePairBehaviour","maxColumnsRequired"),"</p>")))},e.handleFieldMaxColumnsChanged=function(){this.fieldMaxColumns.$input.val()>this.fieldMaxColumns.field.max&&this.fieldMaxColumns.$errors.html("<p>".concat(H5PEditor.t("H5PEditor.ImagePairBehaviour","maxColumnsExceeded"),"</p>"))},i}();H5PEditor=H5PEditor||{},H5PEditor.widgets.imagepairbehaviour=i})();