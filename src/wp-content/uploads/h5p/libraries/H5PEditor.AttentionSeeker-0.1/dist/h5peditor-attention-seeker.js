(()=>{"use strict";const e=function(){function e(e,t,i,n){var a=this;this.parent=e,this.field=t,this.params=i,this.setValue=n,this.field.attentionseeker=this.field.attentionseeker||{},this.changes=[],this.passReadies=!0,this.$container=H5P.jQuery("<div>",{class:"h5peditor-attentionseeker"}),this.fieldInstance=new H5PEditor.widgets[this.field.type](this.parent,this.field,this.params,this.setValue),this.fieldInstance.appendTo(this.$container);var s=this.buildPreview();this.fieldInstance.$content.prepend(s),this.attentionSeeker=new H5P.AttentionSeeker,this.animationParams={style:"none",interval:3e3,repeat:1/0},this.optionFields={},this.optionFields.style=H5PEditor.findField(this.field.attentionseeker.style,this.fieldInstance),this.optionFields.style&&(this.animationParams.style=this.optionFields.style.value,this.optionFields.style.changes.push((function(e){a.startPreviewAnimation({style:e})}))),this.optionFields.interval=H5PEditor.findField(this.field.attentionseeker.interval,this.fieldInstance),this.optionFields.interval&&(this.animationParams.interval=1e3*this.optionFields.interval.value,["keydown","blur","paste"].forEach((function(e){a.optionFields.interval.$input.get(0).addEventListener(e,(function(e){a.handleFieldUpdate("interval",e)}))}))),this.optionFields.repeat=H5PEditor.findField(this.field.attentionseeker.repeat,this.fieldInstance),this.optionFields.repeat&&(this.animationParams.repeat=this.optionFields.repeat.value,["keydown","blur","paste"].forEach((function(e){a.optionFields.repeat.$input.get(0).addEventListener(e,(function(e){a.handleFieldUpdate("repeat",e)}))}))),this.fieldInstance.on("collapsed",(function(){a.attentionSeeker.unregisterAll()})),this.fieldInstance.on("expanded",(function(){a.startPreviewAnimation(a.animationParams,!0)})),this.$errors=this.$container.find(".h5p-errors"),this.fieldInstance.$group.get(0).classList.contains("expanded")||this.startPreviewAnimation(this.animationParams,!0)}var t=e.prototype;return t.handleFieldUpdate=function(e,t){var i=this;("keydown"===t.type&&"Enter"===t.key||"blur"===t.type||"paste"===t.type)&&setTimeout((function(){var t=i.optionFields[e].$input.val(),n=parseInt(t);if("interval"===e?n*=1e3:"repeat"===e&&""===t&&(n=1/0),Number.isInteger(n)||n===1/0){var a={};a[e]=n,a[e]!==i.animationParams[e]&&i.startPreviewAnimation(a)}}),0)},t.startPreviewAnimation=function(e){(e=e||{}).style&&(this.animationParams.style=e.style),e.interval&&(this.animationParams.interval=e.interval),e.repeat&&(this.animationParams.repeat=e.repeat),this.attentionSeeker.unregisterAll(),this.attentionSeeker.register({element:this.previewBallWrapper,style:this.animationParams.style,interval:this.animationParams.interval,repeat:this.animationParams.repeat,options:{runWorker:!0}})},t.buildPreview=function(){var e=document.createElement("div");e.classList.add("h5peditor-attentionseeker-preview"),this.previewBallWrapper=document.createElement("div"),this.previewBallWrapper.classList.add("h5peditor-attentionseeker-preview-ball-wrapper"),e.appendChild(this.previewBallWrapper);var t=document.createElement("div");return t.classList.add("h5peditor-attentionseeker-preview-ball"),this.previewBallWrapper.appendChild(t),e},t.appendTo=function(e){this.$container.appendTo(e)},t.validate=function(){return this.fieldInstance.validate()},t.remove=function(){this.$container.remove()},e}();H5PEditor=H5PEditor||{},H5PEditor.widgets.attentionseeker=e})();